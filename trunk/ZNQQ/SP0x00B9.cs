using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ZNQQ
{
    public class SP0x00B9
    {
        public byte[] bytes = 
        {
            0x02,
            0x30,0x13,
            0x00,0xB9,//CMD
            0x5A,0x2C,
            0x69,0xC7,0x56,0xE8,
            0x02,0x00,0x02,0x00,0x01,
            0x01,0x01,0x00,0x00,0x65,0xCA,

            0x51,0x86,0x94,0x76,0x7F,0x4B,0xEE,0xDC,0x27,0x25,
            0x65,0x55,0x91,0x0F,0xCE,0x0E,0xD6,0xC8,0x9C,0xA9,0x73,0x7B,0x1C,0xA5,0x45,0x5D,
            0x24,0x71,0xC0,0xE4,0xB7,0xD2,0xC8,0xC3,0x7E,0xA8,0xAE,0xEA,0xDD,0x4A,0x7F,0x03,
            0x56,0x7F,0x2F,0xE7,0x39,0xA8,0x06,0x5C,0x59,0xA6,0x51,0x0E,0x6A,0x72,0x57,0x31,
            0x09,0x32,0x75,0x3F,0x14,0x84,0x7D,0xAA,0x86,0x51,0xBC,0xD4,0x51,0x1D,0x22,0x2C,
            0xE8,0xB1,0x84,0x90,0xE7,0xC0,0x20,0x2B,0x9B,0x15,0x1B,0x3D,0x90,0xE9,

            0x03
        };
        byte[] data = 
        { 
            0x13,0x06,0x00,0x30,0xD9,0x39,0x90,0xF7,0xBF,0x1C,0x34,0xC4,0x3D,0xEB,0x17,0xFD,
            0x42,0xAD,0xE1,0x07,0x78,0xB6,0xBD,0xA4,0xD1,0x21,0xBE,0x83,0xE1,0x1D,0x8D,0xE8,
            0x64,0x0A,0x60,0xD9,0x46,0xA3,0x81,0x6E,0xF7,0x9F,0x60,0xC1,0x25,0x78,0x8D,0xEF,
            0x50,0xD8,0x17,0x72,0x00,0x00,0x0A,0x28,0x00,0x00,0x0E,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x97,0xBC,0xF8,0x2E 
        };

        public SP0x00B9()
        { }
        public void PrepareData(byte[] sessionKey)
        {
            Array.Copy(new QQCrypt().QQ_Encrypt(data, sessionKey), 0, bytes, 22, 16);
        }
    }
}
